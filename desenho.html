<!DOCTYPE html>
<html>

<head>
    <meta name="mobile-web-app-capable" content="yes">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <link rel="stylesheet" type="text/css" href="css/desenho.css">
    <link rel="stylesheet" type="text/css" href="css/index.css">
    <script type="module" src="https://cdn.jsdelivr.net/npm/emoji-picker-element@^1/index.js"></script>
    <title>Desenho 0.9.9 alpha</title>
</head>

<body class="naotoque day" style="cursor: pointer;">
    <div id="tela" style="overflow-y: hidden;" class="naotoque">
        <div id="menus">
            <div id="menupicker" class="submenu fundobranco">
                Toque numa área pintada<br>
                para capturar uma cor
            </div>

            <div id="menuinfo" class="submenu fundobranco">
                Feito por:
                <a href="https://diegoferraribruno.github.io/">Diego Ferrari Bruno</a><br> com códigos de<br>
                <a href="https://leimao.github.io/blog/HTML-Canvas-Mouse-Touch-Drawing/" target="_blank">
                    Lei Mao</a> <br>
                <a href="https://github.com/doug2k1/javascript-camera"> Douglas Matoso</a><br>
                versao 0.9.9 alpha<br>
                - Novo estilo de pintura e pinceis<br>
                <a href="http://www.tricedesigns.com/2012/01/04/sketching-with-html5-canvas-and-brush-images"
                    target="blank">com cdigos daqui</a><br>
                - menu apagar junto do menu pincel.<br>
                versão 0.9.9<br>
                - arrumei o colorpicker <br>
                - menus alterados<br>
                - emojis!<br>
                - alteracao do metodo de entrada (pointer)<br>
                - stopVideoStream quando fecha camera<br>
                - (futuros pinceis dinamicos)<br>
                versão 0.9.8 <br>
                - javascript e css em arquivos externos.<br>
                - recorte e rotação <br>(desativado temporariamente)<br>
                - contraste das imagens de grade alteradas<br>
                - incluídos index.css e index.js nas páginas<br>
                - novo index.html para o app<br>
                - realinhamento da tela (zoom)<br>
                - estilo mais minimalista<br>
                <br>
                versão 0.9.7d<br>
                - nova rotacao do canvas. (em desenvolvimento)<br>
                - removido o canvas de recorte<br>
                - zoom 8x<br>
                - tela desvira depois da camera<br>
                - nova paleta de cores<br>
                - Cortar, Rotacionar<br>
                - menu tamanho da tela<br>
                - cores nos botoes<br>
                - importar somente gif bmp jpg<br>
                - mensagem de suporte depois do download<br>
                versão 0.7<br>
                - tela vira quando muda camera<br>
                versão 0.6<br>
                - NOVO gerenciador de memória<br>
                - touchmovecursor<br>
                - melhora na troca de ferramenta<br>
                - desfazer mais leve<br>
                - Desfazer, refazer atualizado. <br>
                - botões maiores e agregados<br>
                - função camera movida e transparencia arrumada<br>
                - camera centralizada (tnx Frederico for the help)<br>
                - seletor de cor (fix).<br>
                ver 0.5 - Turing<br>
                - foto e fundo com tamanho<br>
                - inicia no modo noturno<br>
                - fundo xadrez<br>
                - Alerta ao fim do Crtl+Z e no Ctrl+Y <br>
                - multiplas imagens podem ser inseridas<br>
                - pinta por cima ou por baixo<br>
                - night mode<br>
                - envia imagem.<br><br>
                - nova paleta de cores<br><br>
                - tamanhos pre definidos de pinceis. <br>
                - refazer passo a passo. <br>
                - apagador com transparencia propria.<br>
                - lupa com indicador de zoom. no lugar apropriado<br>
                <br>
                0.4
                reduzida a quantifdade de undos disponiveis porem salvaremos uma imagem que sera carregada
                ao fundo
                o que pode influenciar na qualidade do projeto final. vamos ao teste.
                versões 0
                <br>
            </div>

            <div id="menutamanho" class="fundobranco submenu">
                <div onmousedown="tamanho()" class="bloquinho"
                    style="float: right; color: white; font-family: Arial, Helvetica, sans-serif; font-size: 1.3em; font-weight: bold; background-color: rgba(247, 161, 165, 0.15);">
                    ok
                </div>
                Tamanho da imagem:<br>
                largura: <input id="largura" type="number" maxlength="4" max="1920" value="320"
                    style="width:50px" />px<br>
                altura: <input id="altura" type="number" maxlength="4" max="1920" value="320"
                    style="width:50px" />px<br>
                <br><span class="botao" title="Duplicar tamanho da tela" onclick="x2()">Duplicar o tamanho da tela:
                    ↔️</span><br>
            </div>

            <div id="menuimagem" class="fundobranco submenu aparece menu">
                <span class="botao" title="fechar menu enviar imagem" onmousedown="removeClass()">📤 Enviar uma imagem
                    ❌</span><br>
                <input type="file" id="input" class="custom-file-input" accept=".png, .jpg, .jpeg, .gif .bmp"
                    title="📤" />
            </div>

            <div id="menuemoji" class="fundobranco submenu menu">
                <span title="fechar menu emoji" class="botao" onmousedown="modeTo('emoji')"
                    style="background-color: rgba(247, 161, 165, 0.15);">emoji😍</span><emoji-picker
                    id="emojipicker"></emoji-picker>
                estilo:<span onclick="emojipicker()" id="emoExemplo">😍</span> <br>
                <input type="range" id="emosize" name="strokeSize" min="16" max="320" step="8"
                    oninput="emojiSizeRange()" value="16" width="200px">
                <br>
            </div>

            <div id="menupintar" class="fundobranco submenu menu">
                <span title="fechar menu pintar" class="botao" onmousedown="removeClass()"
                    style="background-color: rgba(247, 161, 165, 0.15);">🖌️ Pincel ❌</span>
                <input type="number" id="tpx" min="0.5" max="100" step="0.5" value="1"
                    onchange="setStrokeSize(this.value)" style="width: 50px; margin-left: 8px">

                <input type="range" id="strokeSize" name="strokeSize" min="1" max="26" step="1"
                    oninput="strokeSizeRange(this.value)" value="6" width="200px">
                <br>
                💧<input type="range" id="A2" name="transparencia" min="0.01" max="1" oninput="mudaCorQ(3,this.value)"
                    step="0.01" value="1"><br>
                <span id="pickerb" title="Pega cor" class=" bot" onmousedown="modeTo('picker')"
                    style="background-color: rgba(247, 161, 165, 0.15);">💉</span>

                <span id="preencher" title="Preencher" onmousedown="modeTo('preencher')" class=" bot"
                    style="background-color: rgba(247, 161, 165, 0.15);">🪣</span>
                <span class="bot" title="modo apagar"
                    onmousedown='changeGCO("destination-out"), removeClass()'>🧽</span><br>
                <span style="float: center; position: relative; width: 70px" onmousedown="changeLine()">estilo:<span
                        id="line">
                        ➕</span></span><br>
                <div id="pinceis"></div>
                <canvas id="brushCanva" width="40px" height="40px" onmousedown="changeBrush(brush)"></canvas><br>
            </div>

            <div id="menuapagar" class="fundobranco submenu">
                <span class="botao" title="fechar menu apagar" onmousedown="removeClass()">🧽 Apagador ❌</span><br>
                <span style="float: center; position: relative; width: 16px" onmousedown="changeLine()"><span
                        id="line2">
                        ➕</span></span>
                <input type="number" id="tpx2" min="0.5" max="100" step="0.3" value=""
                    onchange="setStrokeSize(this.value)" style="width: 50px; margin-left: 8px">
                <input type="range" id="estrokeSize" name="estrokeSize" min="1" max="16" step="1"
                    oninput="strokeSizeRange(this.value)" value="16" width="160px">
                <span onmousedown="removeClass()" id="mostraCor2" style="background-color: 'hsl(0, 100%, 0%);'">
                </span>
                <div>
                    💧<input type="range" id="transparenciaE" name="transparencia" min="0.1" max="1"
                        oninput="mudaCorAlpha()" step="0.1" value="1"></div>
            </div>

            <div id="menucores" class="submenu fundobranco">
                <span class="botao" onmousedown="removeClass()"> 🎨 Menu cores <span id="mostraCor">
                        ❌
                    </span></span><br>
                <div id="paleta2" class="fundobranco">
                    <br>Use o 📌 para guardar <br>ou remover suas cores favoritas.
                </div>
                <div id="paleta" class="fundobranco"></div>
                <div id="menu" class="fundobranco" onmouseover="mostra()">
                    <span id="pickerc" title="Pega cor" class="bloquinho" onmousedown="modeTo(`picker`)"
                        style="margin: -10px 10px 0px 0px; width: 24px; font-size:24px;">💉</span>
                    <span id="salvaCor" onmousedown="salvaCor()" title="Favoritar" class="bloquinho">
                        <span
                            style="margin: -8px 8px 0px 0px; width: 20px; padding-left:10px; padding-top:-8px; font-size:24px;">📌</span>

                    </span><br>
                    🌈<input type="range" id="H" name="cor" min="0" max="359" oninput="mudaCorQ(0,this.value)"
                        value="0"> <br>
                    ◒ <input type="range" id="S" name="cor" min="0" max="100" oninput="mudaCorQ(1,this.value)"
                        value="100"> <br>
                    🔆 <input type="range" id="L" name="cor" min="0" max="100" oninput="mudaCorQ(2,this.value)"
                        value="50"> <br>
                    💧<input type="range" id="A" name="cor" min="0.01" max="1" oninput="mudaCorQ(3,this.value)"
                        step="0.01" value="1"><br>
                </div>

                <div id="paleta3" class="fundobranco"></div>
            </div>

            <div id="menufundo" class="fundobranco submenu naotoque" style="text-align: center; height: auto;">
                <span title="Configurações" class="botao" onmousedown="modeTo('fundo')">🖥️ menu configurações ❌</span>
                <span class="botao" title="Redimensionar tela" onclick="tamanhom()">↔️ Redimensionar a tela</span>
                <!--
                <span id="rotacionar" class="botao" onclick="modeTo('rotacionar')">🔃 Rotacionar a tela </span-->

                <span id="night" class="botao" onmousedown="night()">🌒 Modo Noturno / Diurno</span>

                <span id="oculos" class="botao" onmousedown="pixel()">👓 Suavização de pixels </span>
                <span id="info" title="Informações" class="botao" onmousedown="modeTo('info')">ℹ️ Informações </span>
                <span id="fundo falso" class="botao"> Adicionar Fundo falso:<br>
                    <span onmousedown="Fundo('img')" class="bloquinho">🌎</span>
                    <span onmousedown="Fundo('black')" class="bloquinho" style="background-color: hsla(0, 100%, 0%, 1)">
                    </span>
                    <span onmousedown="Fundo('white')" class="bloquinho"
                        style="background-color: hsla(0, 100%, 100%, 1)">
                    </span>
                    <span onmousedown="Fundo('img/grid.png')" class="bloquinho"
                        style="background-image: url('./img/grid.png')">.</span>
                    <span onmousedown="Fundo('img/grid2.png')" class="bloquinho"
                        style="background-image: url('./img/grid2.png'); background-color: #fff"></span>
                    <span onmousedown="Fundo('img/grid3.png')" class="bloquinho"
                        style="background-image: url('./img/grid3.png')"></span>
                    <span onmousedown="Fundo('none')" class="bloquinho"
                        style="background-color: hsla(0, 100%, 100%, 0)">
                        ❌</span>
                    <span>
                        <input type="file" id="input2" class="custom-file-input"
                            accept=".png, .jpg, .jpeg, .gif .bmp" />
                    </span></span>

            </div>

            <div id="menupreencher" class="fundobranco submenu">
                <span class="botao" onmousedown="removeClass()">🪣 Preencher tudo ❌</span>
                <span width="140px" style="margin: 8px 80px; display: block">
                    <span onmousedown="mudaCorBG('black')" class="bloquinho"
                        style="background-color: hsla(0, 100%, 0%, 1)">
                    </span>
                    <span onmousedown="mudaCorBG('white')" class="bloquinho"
                        style="background-color: hsla(0, 100%, 100%, 1)">
                    </span>
                    <span onmousedown="mudaCorBG('strokeColor')" id="preenchercor" class="bloquinho"
                        style="background-color: rgba(158, 239, 129, 0.28);">
                    </span>
                </span>
            </div>

            <div id="menuzoom" class="fundobranco submenu">
                <input id="zoombar" type="range" min="0" max="3" value="1" step="1" onchange="ZOOMf(this.value)">
                <input id="tzoom" type="number" min="0.50" max="4" step="0.5" value="1" onchange="ZOOM(this.value)"
                    style="width: 44px">
                <span onmousedown="scrollCanva(-80,0)">⬅️</span>
                <span onmousedown="scrollCanva(0,-80)">⬆️</span>
                <span onmousedown="scrollCanva(0,80)">⬇️</span>
                <span onmousedown="scrollCanva(80,0)">➡️</span>
            </div>

            <div id="menurecortar" class="fundobranco submenu">
                <span class="botao" title="Redimensionar tela" onclick="tamanhom()">↔️ Redimensionar a tela</span>
                <span id="recortarbot" title="Recotar para seleção" class="botao" onclick="cortar()">✂️ Recortar para
                    seleção</span>
                <span onmousedown="comandosExec()" title="Cancela" class="botao">
                    ❌ Cancelar</span>

            </div>

            <div id="menurotacionar" class="fundobranco submenu">
                <span id="rotacionar" class="botao" onclick="rotacionar()">🔃 Rotacionar a tela </span>
                <span id="rotacionar" class="botao" onclick="comandoR()">✔️ confirmar rotação </span>

            </div>
        </div>

        <div id="desenho_div" style="overflow-y: hidden;" class="naotoque">

            <div id="ferramentas" class="ferramentas">
                <span id="fundo" title="Configurações" class="mais" onmousedown="modeTo('fundo')">🖥️</span>
                <!--span id="recortar" class="mais" onclick="modeTo('recortar')">✂️</span -->
                <span class="mais" title="Limpar tela" onmousedown="clearArea()">🗑</span>
                <span id="imagem" title="adicionar imagem" class="mais" onmousedown="modeTo('imagem')"> 📤</span>
                <span id="btn-download" title="salvar imagem" class="mais">📥</span>
                <span id="undo" title="desfazer" class="mais" onmousedown="undoT()" onmouseup="undoTEnd()"
                    onmouseleave="undoTEnd()">↩️</span>
                <span id="redo" title="refazer" class="mais" onmousedown="redoT()" onmouseup="redoTEnd()"
                    onmouseleave="redoTEnd()">↪️</span>
                <span id="cam" title="foto" class="mais" onmousedown="modeTo('cam')">📷</span>
                <span id="emoji" title="pintar emoji" class="mais selected" onmousedown="modeTo('emoji')">😍</span>
            </div>

            <div id="ferramentas2" class="ferramentas">
                <span onmousedown="backPaint()" class="mais" id="globalComposite"
                    style="width: 36px; height: 36px; padding-top: 2px; margin-right: 6px; display:flex;"><span
                        style="position:absolute; width:30px; display:block; color:white; margin-left:-4px; padding-top:4px;">⭕</span>
                    <span
                        style="position:relative; float:left; width:30px; display:block;  color:black; left:2px; margin-top:0px;"
                        title="Pintando por baixo">🔲</span>
                </span>
                <span id="pintar" title="pintar" class="mais selected" onmousedown="modeTo('pintar')"
                    style="background-color: rgba(247, 161, 165, 0.15);">🖌️</span> <span id="cores" title="cores"
                    class="mais" onmousedown="modeTo('cores')"
                    style="background-color: rgba(247, 161, 165, 0.15);">🎨</span>
                <span id="picker" title="Pega cor" class="mais" onmousedown="modeTo('picker')"
                    style="background-color: rgba(247, 161, 165, 0.15);">💉</span>
                <!--span id="apagar" title="Apagar" class="mais" onmousedown="modeTo('apagar')">🧽</span-->

                <span id="apagar" title="Apagar" class="mais" onmousedown='changeGCO("destination-out")'>🧽</span>
                <span id="zoom" title="Ampliar" class="mais" onmousedown="modeTo('zoom')">🔎<span id="x1"
                        style="font-size: 0.6em; display:block; position:absolute; margin-top: -24px; width:20px; height:20px;">1x</span></span>
                <span id="hand" class="mais" title="Mover a tela" onclick="toggleHand()">🖐</span>
            </div>

            <div id="canvas_window">
                <span id="cursor"
                    style="left: 677px; top: 342px; width: 35px; height: 35px; margin-top: -17.5px; margin-left: -17.5px; border-color: rgba(247, 161, 165, 0.15);"
                    class="naotoque cursorIndex" onselectstart="return false;" ondragstart="return false;"></span>
                <div id="canvas_div2">

                    <div id="canvas_div">
                        <canvas id="canvas" width="320px" height="320px" onmousemove="cursorMove(event)"
                            onmouseout="mostra()">
                            Seu navegador nao suporta o elemento de canvas ou vc está offline e algo não carregou
                            corretamente.<br>
                        </canvas>
                    </div>
                </div>

            </div>

            <div id="menucam" style="display:block; visibility:hidden;"></div>
        </div>
    </div>
    <canvas id="canvasV" width="428px" height="320px" onmousemove="cursorMove(event)" onmouseout="mostra()"
        style="visibility: hidden; position: absolute; left:0px;"></canvas>
    <script type="text/javascript" src="js/desenho.js"></script>
    <script type="text/javascript" src="js/index.js"></script>
</body>

</html>